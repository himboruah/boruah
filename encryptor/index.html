<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Text & File Encryptor</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="app-shell">
    <h1>Text & File Encryptor</h1>
    <div id="libraryError" class="api-warning hidden"></div>

    <div class="viewport" aria-live="polite">
      <div id="sliderTrack" class="track track--show-text" role="group" aria-roledescription="carousel">
        <section class="panel panel--text" aria-label="Text Encryptor" aria-hidden="false">
          <div class="panel-inner">
            <h2 tabindex="-1">Text Encryptor</h2>

            <div class="input-group">
              <label for="text">Enter Text</label>
              <textarea id="text" rows="5" placeholder="Enter text to encrypt or decrypt"></textarea>
            </div>

            <div class="input-group passphrase-group">
              <label for="passphrase">Passphrase</label>
              <div class="input-with-icon-wrapper">
                <input type="password" id="passphrase" placeholder="Enter a secret passphrase" />
                <button id="togglePass" type="button" class="icon-btn" title="Show/Hide Password" aria-label="Show password">
                  <svg class="icon-eye" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M12 5c-5.5 0-9.7 3.6-11 7 1.3 3.4 5.5 7 11 7s9.7-3.6 11-7c-1.3-3.4-5.5-7-11-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>
                    <circle cx="12" cy="12" r="2.5"/>
                  </svg>
                  <svg class="icon-eye-off" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M3.5 2.1 2.1 3.5l3.2 3.2C3.4 8 1.9 9.8 1 12c1.3 3.4 5.5 7 11 7 2 0 3.9-.4 5.6-1.2l3.8 3.8 1.4-1.4L3.5 2.1zM7.9 7.9l1.7 1.7a3 3 0 0 0 4.8 3.3l1.6 1.6A5 5 0 0 1 7.9 7.9zm4.1-3c5.5 0 9.7 3.6 11 7-.6 1.5-1.7 3.1-3.3 4.5l-1.4-1.4c1.2-1 2-2 2.6-3.1-1.1-2.3-4.8-5.9-8.9-5.9-1 0-1.9.1-2.8.4l-1.5-1.5c1.3-.4 2.8-.7 4.3-.7z"/>
                  </svg>
                </button>
              </div>
              <div class="pass-strength-meter" id="passphraseStrength"></div>
              <p class="pass-strength-feedback" id="passphraseFeedback"></p>
            </div>

            <div class="input-row">
              <button class="btn" id="encryptBtn">Encrypt</button>
              <button class="btn" id="decryptBtn">Decrypt</button>
            </div>

            <p class="hint">Text mode uses AES-GCM with Argon2id key derivation (t=3, m=64MiB, p=2), 32-byte salt, 12-byte IV; metadata bound via AAD.</p>

            <div class="output hidden" id="outputBox">
              <h3>Result</h3>
              <div id="result" class="output-box"></div>
              <p class="hint">This output contains non-secret metadata (salt, IV, etc.) required for decryption.</p>
              <div class="input-row">
                <button class="btn" id="copyBtn">Copy</button>
                <button class="btn reset-btn" id="resetBtn">Reset</button>
              </div>
            </div>
          </div>

          <button class="switcher switcher--right" id="openFilePanel" aria-label="Open File Encryptor" title="Open File Encryptor">
            <span>File Encryptor</span>
          </button>
        </section>

        <section class="panel panel--file" aria-label="File Encryptor" aria-hidden="true">
          <div class="panel-inner">
            <h2 tabindex="-1">File Encryptor</h2>

            <div id="fileApiWarning" class="api-warning hidden">
              Your browser doesn't support direct file saving. Encryption is disabled, but decryption will work via a download link.
            </div>

            <div class="input-group">
              <label for="fileInput">Choose a file</label>
              <input type="file" id="fileInput" />
              <div id="dropZone" class="drop-zone">Drop file here or paste (Ctrl/Cmd+V)</div>
            </div>

            <div class="input-group passphrase-group">
              <label for="filePassphrase">Passphrase</label>
              <div class="input-with-icon-wrapper">
                <input type="password" id="filePassphrase" placeholder="Enter a secret passphrase" />
                <button id="toggleFilePass" type="button" class="icon-btn" title="Show/Hide Password" aria-label="Show password">
                  <svg class="icon-eye" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M12 5c-5.5 0-9.7 3.6-11 7 1.3 3.4 5.5 7 11 7s9.7-3.6 11-7c-1.3-3.4-5.5-7-11-7zm0 12a5 5 0 1 1 0-10 5 5 0 0 1 0 10z"/>
                    <circle cx="12" cy="12" r="2.5"/>
                  </svg>
                  <svg class="icon-eye-off" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M3.5 2.1 2.1 3.5l3.2 3.2C3.4 8 1.9 9.8 1 12c1.3 3.4 5.5 7 11 7 2 0 3.9-.4 5.6-1.2l3.8 3.8 1.4-1.4L3.5 2.1zM7.9 7.9l1.7 1.7a3 3 0 0 0 4.8 3.3l1.6 1.6A5 5 0 0 1 7.9 7.9zm4.1-3c5.5 0 9.7 3.6 11 7-.6 1.5-1.7 3.1-3.3 4.5l-1.4-1.4c1.2-1 2-2 2.6-3.1-1.1-2.3-4.8-5.9-8.9-5.9-1 0-1.9.1-2.8.4l-1.5-1.5c1.3-.4 2.8-.7 4.3-.7z"/>
                  </svg>
                </button>
              </div>
              <div class="pass-strength-meter" id="filePassphraseStrength"></div>
              <p class="pass-strength-feedback" id="filePassphraseFeedback"></p>
            </div>

            <div class="input-row">
              <button class="btn" id="encryptFileBtn">Encrypt File</button>
              <button class="btn" id="decryptFileBtn">Decrypt .bfe</button>
            </div>

            <div class="progress-row hidden" id="fileProgressRow">
              <progress id="fileProgress" value="0" max="100" aria-label="File progress"></progress>
              <span id="fileStatus"></span>
              <button class="btn reset-btn" id="cancelBtn" title="Cancel current operation">Cancel</button>
            </div>
            
            <div class="output hidden" id="fallbackOutputBox">
              <h3>Download Ready</h3>
              <a id="fallbackDownloadLink" class="btn" href="#" download>Download Decrypted File</a>
              <button class="btn reset-btn" id="resetFileBtn">Reset</button>
            </div>
            
            <p class="hint">File mode uses AES-GCM with Argon2id (t=3, m=64 MiB, p=2). The v5 format encrypts all metadata including the filename.</p>
          </div>

          <button class="switcher switcher--left" id="openTextPanel" aria-label="Open Text Encryptor" title="Open Text Encryptor">
            <span>Text Encryptor</span>
          </button>
        </section>
      </div>
    </div>
  </div>

  <script src="./argon2-bundled.min.js"></script>
  <script src="./script.js"></script>
</body>
</html>